# Plot results

set term png enhanced

set datafile separator ','

set grid

set xlabel "Scale Factor"
set ylabel "TPS"

set style boxplot outliers
set style data boxplot
set boxwidth 0.4
set style fill solid 0.5 border

factors="`tail -n+2 postgresql.baseline.csv|awk -F ',' '{print $1, "\n"}'|sort -un`"
n_f = words(factors)

set xtic ("" 1)
set for [i=1:n_f] xtics add (word(factors,i) i)

filter(col, factor_col, level) = (strcol(factor_col) eq word(factors, level)) ? column(col) : 1/0
system "echo " . factors . "1>&2"

#plot for [i=1:n_f] 'postgresql.baseline.csv' using (i - 0.21):(filter(3, 1, i)) lc rgb 'red' notitle, \
#  for [i=1:n_f] 'postgresql.ipcd.csv' using (i + 0.21):(filter(3, 1, i)) lc rgb 'blue' notitle, \
#    1/0 with boxplot lc rgb 'red' title 'Baseline', \
#    1/0 with boxplot lc rgb 'blue' title 'IPCD'

set style data histogram
plot 'postgresql.baseline.csv' using 1:3 w boxes, \
  'postgresql.ipcd.csv' using 1:3 w boxes
